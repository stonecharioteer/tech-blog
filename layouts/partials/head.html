<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
{{- if hugo.IsProduction | or (eq site.Params.env "production") | and (ne .Params.robotsNoIndex true) }}
<meta name="robots" content="index, follow">
{{- else }}
<meta name="robots" content="noindex, nofollow">
{{- end }}

{{- /* Title */}}
<title>{{ if .IsHome }}{{ else }}{{ if .Title }}{{ .Title }} | {{ end }}{{ end }}{{ site.Title }}</title>

{{- /* Meta */}}
{{- if .IsHome }}
{{ with site.Params.keywords -}}<meta name="keywords" content="{{- range $i, $e := . }}{{ if $i }}, {{ end }}{{ $e }}{{ end }}">{{ end }}
{{- else }}
<meta name="keywords" content="{{ if .Params.keywords -}}
    {{- range $i, $e := .Params.keywords }}{{ if $i }}, {{ end }}{{ $e }}{{ end }} {{- else }}
    {{- range $i, $e := .Params.tags }}{{ if $i }}, {{ end }}{{ $e }}{{ end }} {{- end -}}">
{{- end }}
<meta name="description" content="{{- with .Description }}{{ . }}{{- else }}{{- if or .IsPage .IsSection}}
    {{- .Summary | default (printf "%s - %s" .Title  site.Title) }}{{- else }}
    {{- with site.Params.description }}{{ . }}{{- end }}{{- end }}{{- end -}}">
<meta name="author" content="{{ (partial "author.html" . ) }}">
<link rel="canonical" href="{{ if .Params.canonicalURL -}} {{ trim .Params.canonicalURL " " }} {{- else -}} {{ .Permalink }} {{- end }}">
{{- if site.Params.analytics.google.SiteVerificationTag }}
<meta name="google-site-verification" content="{{ site.Params.analytics.google.SiteVerificationTag }}">
{{- end }}
{{- if site.Params.analytics.yandex.SiteVerificationTag }}
<meta name="yandex-verification" content="{{ site.Params.analytics.yandex.SiteVerificationTag }}">
{{- end }}
{{- if site.Params.analytics.bing.SiteVerificationTag }}
<meta name="msvalidate.01" content="{{ site.Params.analytics.bing.SiteVerificationTag }}">
{{- end }}
{{- if site.Params.analytics.naver.SiteVerificationTag }}
<meta name="naver-site-verification" content="{{ site.Params.analytics.naver.SiteVerificationTag }}">
{{- end }}

{{- /* Styles */}}

{{- /* includes */}}
{{- $includes := slice }}
{{- $includes = $includes | append (" " | resources.FromString "assets/css/includes-blank.css")}}

{{- if not (eq site.Params.assets.disableScrollBarStyle true) }}
    {{- $ScrollStyle := (resources.Get "css/includes/scroll-bar.css") }}
    {{- $includes = (append $ScrollStyle $includes) }}
{{- end }}

{{- $includes_all := $includes | resources.Concat "assets/css/includes.css" }}

{{- $theme_vars := (resources.Get "css/core/theme-vars.css") }}
{{- $reset := (resources.Get "css/core/reset.css") }}
{{- $media := (resources.Get "css/core/zmedia.css") }}
{{- $license_css := (resources.Get "css/core/license.css") }}
{{- $common := (resources.Match "css/common/*.css") | resources.Concat "assets/css/common.css" }}

{{- /* markup.highlight.noClasses should be set to `false` */}}
{{- $chroma_styles := (resources.Get "css/includes/chroma-styles.css") }}
{{- $chroma_mod := (resources.Get "css/includes/chroma-mod.css") }}

{{- /* order is important */}}
{{- $core := (slice $theme_vars $reset $common $chroma_styles $chroma_mod $includes_all $media) | resources.Concat "assets/css/core.css" | resources.Minify }}
{{- $extended := (resources.Match "css/extended/*.css") | resources.Concat "assets/css/extended.css" | resources.Minify }}

{{- /* bundle all required css */}}
{{- /* Add extended css after theme style */ -}}
{{- $stylesheet := (slice $license_css $core $extended) | resources.Concat "assets/css/stylesheet.css"  }}

{{- if not site.Params.assets.disableFingerprinting }}
{{- $stylesheet := $stylesheet | fingerprint }}
<link crossorigin="anonymous" href="{{ $stylesheet.RelPermalink }}" integrity="{{ $stylesheet.Data.Integrity }}" rel="preload stylesheet" as="style">
{{- else }}
<link crossorigin="anonymous" href="{{ $stylesheet.RelPermalink }}" rel="preload stylesheet" as="style">
{{- end }}

{{- /* Search */}}
{{- if (eq .Layout `search`) -}}
<link crossorigin="anonymous" rel="preload" as="fetch" href="../index.json">
{{- $fastsearch := resources.Get "js/fastsearch.js" | js.Build (dict "params" (dict "fuseOpts" site.Params.fuseOpts)) | resources.Minify }}
{{- $fusejs := resources.Get "js/fuse.basic.min.js" }}
{{- $license_js := resources.Get "js/license.js" }}
{{- if not site.Params.assets.disableFingerprinting }}
{{- $search := (slice $fusejs $license_js $fastsearch ) | resources.Concat "assets/js/search.js" | fingerprint }}
<script defer crossorigin="anonymous" src="{{ $search.RelPermalink }}" integrity="{{ $search.Data.Integrity }}"></script>
{{- else }}
{{- $search := (slice $fusejs $fastsearch ) | resources.Concat "assets/js/search.js" }}
<script defer crossorigin="anonymous" src="{{ $search.RelPermalink }}"></script>
{{- end }}
{{- end -}}

{{- /* Favicons */}}
<link rel="icon" href="{{ site.Params.assets.favicon | default "favicon.ico" | absURL }}">
<link rel="icon" type="image/png" sizes="16x16" href="{{ site.Params.assets.favicon16x16 | default "favicon-16x16.png" | absURL }}">
<link rel="icon" type="image/png" sizes="32x32" href="{{ site.Params.assets.favicon32x32 | default "favicon-32x32.png" | absURL }}">
<link rel="apple-touch-icon" href="{{ site.Params.assets.apple_touch_icon | default "apple-touch-icon.png" | absURL }}">
<link rel="mask-icon" href="{{ site.Params.assets.safari_pinned_tab | default "safari-pinned-tab.svg" | absURL }}">
<meta name="theme-color" content="{{ site.Params.assets.theme_color | default "#2e2e33" }}">
<meta name="msapplication-TileColor" content="{{ site.Params.assets.msapplication_TileColor | default "#2e2e33" }}">

{{- /* RSS */}}
{{ range .AlternativeOutputFormats -}}
<link rel="{{ .Rel }}" type="{{ .MediaType.Type | html }}" href="{{ .Permalink | safeURL }}">
{{ end -}}
{{- range .AllTranslations -}}
<link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}">
{{ end -}}

<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    {{- if (and (ne site.Params.defaultTheme "light") (ne site.Params.defaultTheme "dark")) }}
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
    {{- end }}
</noscript>

<style>
    .admonition {
        margin: 1.5rem 0;
        border-left: 4px solid;
        border-radius: 0.25rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }
    
    .admonition-title {
        padding: 0.75rem 1rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .admonition-content {
        padding: 0 1rem 1rem;
    }
    
    .admonition-content p:last-child {
        margin-bottom: 0;
    }
    
    .admonition.note {
        border-left-color: #3b82f6;
        background-color: #eff6ff;
    }
    
    .admonition.note .admonition-title {
        background-color: #dbeafe;
        color: #1e40af;
    }
    
    .admonition.info {
        border-left-color: #06b6d4;
        background-color: #ecfeff;
    }
    
    .admonition.info .admonition-title {
        background-color: #cffafe;
        color: #0e7490;
    }
    
    .admonition.warning {
        border-left-color: #f59e0b;
        background-color: #fffbeb;
    }
    
    .admonition.warning .admonition-title {
        background-color: #fef3c7;
        color: #92400e;
    }
    
    .admonition.tip {
        border-left-color: #10b981;
        background-color: #ecfdf5;
    }
    
    .admonition.tip .admonition-title {
        background-color: #d1fae5;
        color: #065f46;
    }
    
    .admonition.quote {
        border-left-color: #6b7280;
        background-color: #f9fafb;
    }
    
    .admonition.quote .admonition-title {
        background-color: #f3f4f6;
        color: #374151;
    }
    
    .admonition.quote .admonition-content {
        font-family: Georgia, "Times New Roman", Times, serif;
        font-style: italic;
        line-height: 1.6;
    }
    
    .admonition-quote-footer {
        margin-top: 1rem;
        text-align: right;
        font-style: normal;
        font-weight: 500;
        font-size: 0.9em;
        opacity: 0.8;
    }
    
    .admonition.example {
        border-left-color: #8b5cf6;
        background-color: #f5f3ff;
    }
    
    .admonition.example .admonition-title {
        background-color: #ede9fe;
        color: #5b21b6;
    }
    
    /* Dark mode styles */
    .dark .admonition.note {
        background-color: #1e3a8a;
        border-left-color: #60a5fa;
    }
    
    .dark .admonition.note .admonition-title {
        background-color: #1e40af;
        color: #bfdbfe;
    }
    
    .dark .admonition.note .admonition-content {
        color: #e0e7ff;
    }
    
    .dark .admonition.info {
        background-color: #164e63;
        border-left-color: #22d3ee;
    }
    
    .dark .admonition.info .admonition-title {
        background-color: #0e7490;
        color: #a5f3fc;
    }
    
    .dark .admonition.info .admonition-content {
        color: #cffafe;
    }
    
    .dark .admonition.warning {
        background-color: #92400e;
        border-left-color: #fbbf24;
    }
    
    .dark .admonition.warning .admonition-title {
        background-color: #b45309;
        color: #fde68a;
    }
    
    .dark .admonition.warning .admonition-content {
        color: #fef3c7;
    }
    
    .dark .admonition.tip {
        background-color: #064e3b;
        border-left-color: #34d399;
    }
    
    .dark .admonition.tip .admonition-title {
        background-color: #065f46;
        color: #a7f3d0;
    }
    
    .dark .admonition.tip .admonition-content {
        color: #d1fae5;
    }
    
    .dark .admonition.quote {
        background-color: #374151;
        border-left-color: #9ca3af;
    }
    
    .dark .admonition.quote .admonition-title {
        background-color: #4b5563;
        color: #d1d5db;
    }
    
    .dark .admonition.quote .admonition-content {
        color: #f3f4f6;
    }
    
    .dark .admonition-quote-footer {
        color: #d1d5db;
    }
    
    .dark .admonition.example {
        background-color: #581c87;
        border-left-color: #a78bfa;
    }
    
    .dark .admonition.example .admonition-title {
        background-color: #6b21a8;
        color: #c4b5fd;
    }
    
    .dark .admonition.example .admonition-content {
        color: #e9d5ff;
    }
    
    /* CHROMA SYNTAX HIGHLIGHTING FIX - HIGHEST PRIORITY */
    /* Light mode code blocks - target ALL possible containers */
    .chroma,
    .highlight,
    .highlight .chroma,
    div.highlight,
    div.highlight .chroma,
    pre.chroma,
    .highlight pre.chroma,
    .highlight pre,
    pre,
    .lntable,
    .lntd,
    .lntd pre,
    .lntd pre.chroma,
    .highlight .lntable,
    .highlight .lntd,
    .highlight .lntd pre,
    .highlight .lntd pre.chroma,
    div.highlight .lntable,
    div.highlight .lntd,
    div.highlight .lntd pre,
    div.highlight .lntd pre.chroma {
        background-color: #f6f8fa !important;
        color: #24292e !important;
    }
    
    /* Dark mode code blocks - target ALL possible containers */
    .dark .chroma,
    .dark .highlight,
    .dark .highlight .chroma,
    .dark div.highlight,
    .dark div.highlight .chroma,
    .dark pre.chroma,
    .dark .highlight pre.chroma,
    .dark .highlight pre,
    .dark pre,
    .dark .lntable,
    .dark .lntd,
    .dark .lntd pre,
    .dark .lntd pre.chroma,
    .dark .highlight .lntable,
    .dark .highlight .lntd,
    .dark .highlight .lntd pre,
    .dark .highlight .lntd pre.chroma,
    .dark div.highlight .lntable,
    .dark div.highlight .lntd,
    .dark div.highlight .lntd pre,
    .dark div.highlight .lntd pre.chroma {
        background-color: #24273a !important;
        color: #cad3f5 !important;
    }
    
    /* Media query fallback - target ALL possible containers */
    @media (prefers-color-scheme: dark) {
        body:not(.light) .chroma,
        body:not(.light) .highlight,
        body:not(.light) .highlight .chroma,
        body:not(.light) div.highlight,
        body:not(.light) div.highlight .chroma,
        body:not(.light) pre.chroma,
        body:not(.light) .highlight pre.chroma,
        body:not(.light) .highlight pre,
        body:not(.light) pre,
        body:not(.light) .lntable,
        body:not(.light) .lntd,
        body:not(.light) .lntd pre,
        body:not(.light) .lntd pre.chroma,
        body:not(.light) .highlight .lntable,
        body:not(.light) .highlight .lntd,
        body:not(.light) .highlight .lntd pre,
        body:not(.light) .highlight .lntd pre.chroma,
        body:not(.light) div.highlight .lntable,
        body:not(.light) div.highlight .lntd,
        body:not(.light) div.highlight .lntd pre,
        body:not(.light) div.highlight .lntd pre.chroma {
            background-color: #24273a !important;
            color: #cad3f5 !important;
        }
    }
    
    /* WORKING SOLUTION - Use attribute selectors for maximum coverage */
    /* Extra specific for light mode */
    body:not(.dark) [class*="chroma"],
    body:not(.dark) [class*="highlight"],
    body:not(.dark) [class*="lnt"],
    body:not(.dark) pre,
    body:not(.dark) code,
    [class*="chroma"],
    [class*="highlight"],
    [class*="lnt"],
    pre,
    code {
        background-color: #f6f8fa !important;
        color: #24292e !important;
    }
    
    .dark [class*="chroma"],
    .dark [class*="highlight"], 
    .dark [class*="lnt"],
    .dark pre,
    .dark code {
        background-color: #24273a !important;
        color: #cad3f5 !important;
    }
    
    /* Media query fallback */
    @media (prefers-color-scheme: dark) {
        body:not(.light) [class*="chroma"],
        body:not(.light) [class*="highlight"],
        body:not(.light) [class*="lnt"],
        body:not(.light) pre,
        body:not(.light) code {
            background-color: #24273a !important;
            color: #cad3f5 !important;
        }
    }
    
    /* FINAL OVERRIDE - Ensure light mode works with better contrast */
    body:not(.dark) [class*="chroma"],
    body:not(.dark) [class*="highlight"],
    body:not(.dark) [class*="lnt"],
    body:not(.dark) pre,
    body:not(.dark) code {
        background-color: #f8f9fa !important;
        color: #1a1a1a !important;
        border: none !important;
        outline: none !important;
        box-shadow: none !important;
        border-radius: 8px !important;
    }
    
    /* Remove ALL borders and outlines from light mode code elements */
    body:not(.dark) .highlight,
    body:not(.dark) .highlight > div,
    body:not(.dark) .lntable,
    body:not(.dark) .lntd {
        border: none !important;
        outline: none !important;
        box-shadow: none !important;
    }
    
    /* Enhanced syntax colors for light mode - maximum contrast */
    body:not(.dark) .chroma .k,
    body:not(.dark) .chroma .kd,
    body:not(.dark) .chroma .kn,
    body:not(.dark) .chroma .kp,
    body:not(.dark) .chroma .kr,
    body:not(.dark) .chroma .kt { color: #d01040 !important; font-weight: 600 !important; } /* Keywords - bold red */
    
    body:not(.dark) .chroma .s,
    body:not(.dark) .chroma .s1,
    body:not(.dark) .chroma .s2,
    body:not(.dark) .chroma .sb,
    body:not(.dark) .chroma .sc { color: #003d99 !important; } /* Strings - much darker blue */
    
    body:not(.dark) .chroma .nf,
    body:not(.dark) .chroma .fm { color: #6610f2 !important; font-weight: 500 !important; } /* Functions - bold purple */
    
    body:not(.dark) .chroma .c,
    body:not(.dark) .chroma .c1,
    body:not(.dark) .chroma .cm { color: #198754 !important; font-style: italic !important; } /* Comments - green italic */
    
    body:not(.dark) .chroma .m,
    body:not(.dark) .chroma .mi,
    body:not(.dark) .chroma .mf { color: #fd7e14 !important; } /* Numbers - orange */
    
    body:not(.dark) .chroma .ln,
    body:not(.dark) .chroma .lnt { color: #adb5bd !important; } /* Line numbers - gray */
    
    body:not(.dark) .chroma .p { color: #495057 !important; } /* Punctuation - dark gray */
    
    /* Fix specific problematic elements */
    body:not(.dark) .chroma .nc,
    body:not(.dark) .chroma .no { color: #d63384 !important; font-weight: 600 !important; } /* Types like "Package" - magenta */
    
    body:not(.dark) .chroma .nt { color: #003d99 !important; font-weight: 600 !important; } /* Type hints like "String" - much darker blue */
    
    body:not(.dark) .chroma .na,
    body:not(.dark) .chroma .nx { color: #1a1a1a !important; } /* Attributes and names - black */
    
    /* Target self/&self parameters and other variable references */
    body:not(.dark) .chroma .nv,
    body:not(.dark) .chroma .vc,
    body:not(.dark) .chroma .vg,
    body:not(.dark) .chroma .vi,
    body:not(.dark) .chroma .vm { color: #003d99 !important; font-weight: 500 !important; } /* Variables like self/&self - dark blue */
    
    /* AGGRESSIVE OVERRIDE - catch any remaining light blue elements */
    body:not(.dark) .chroma .nb,
    body:not(.dark) .chroma .bp,
    body:not(.dark) .chroma .nd,
    body:not(.dark) .chroma .nn { color: #003d99 !important; font-weight: 500 !important; } /* Built-ins, decorators, namespaces - dark blue */
    
    /* Final catchall for any elements that might still be light blue */
    body:not(.dark) .chroma [style*="color:#8aadf4"],
    body:not(.dark) .chroma [style*="color:#91d7e3"] { color: #003d99 !important; }

    /* Simple dotted underline for all links */
    a {
        text-decoration: underline;
        text-decoration-style: dotted;
        text-underline-offset: 3px;
    }

    a:hover {
        text-decoration-style: solid;
    }
</style>

{{- partial "extend_head.html" . -}}

{{- /* Misc */}}
{{- if hugo.IsProduction | or (eq site.Params.env "production") }}
{{- partial "google_analytics.html" . }}
{{- partial "templates/opengraph.html" . }}
{{- partial "templates/twitter_cards.html" . }}
{{- partial "templates/schema_json.html" . }}
{{- end -}}
{{ if .Params.private }}
<meta name="robots" content="noindex, nofollow">
{{ end }}
